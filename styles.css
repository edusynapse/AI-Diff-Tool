body { font-family: Arial, sans-serif; padding: 20px; background: #f4f4f4; }
h1, label, #error, #key-warning { transition: color 150ms ease; }
body { color: #111; transition: background 150ms ease, color 150ms ease; }
h1 { text-align: center; color: #333; }
label { display: block; margin: 10px 0 5px; font-weight: bold; }
textarea, input[type="file"], input[type="password"], select { width: 100%; padding: 10px; margin-bottom: 15px; border: 1px solid #ccc; border-radius: 4px; }
button { padding: 10px 20px; background: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer; margin-right: 10px; }
button:hover { background: #0056b3; }
button:disabled { background: #ccc; cursor: not-allowed; }
#output-container { position: relative; }
#output { background: white; padding: 15px; border: 1px solid #ddd; border-radius: 4px; max-height: 300px; overflow-y: auto; white-space: pre-wrap; margin-bottom: 15px; }
#copyBtn { position: absolute; top: 5px; right: 5px; padding: 5px 10px; font-size: 0.8em; }
#error { color: red; margin-top: 10px; }
#loading { text-align: center; margin: 20px; }
.spinner { border: 4px solid #f3f3f3; border-top: 4px solid #3498db; border-radius: 50%; width: 20px; height: 20px; animation: spin 1s linear infinite; display: inline-block; }
@keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
@media (max-width: 600px) { body { padding: 10px; } textarea { height: 150px; } }
#key-warning { color: orange; font-size: 0.9em; margin-bottom: 15px; }
#apiKey:disabled { background: #e9e9e9; color: #666; }  /* Greyed out style */
#apiKeyContainer { display: flex; align-items: center; }
#apiKey { flex: 1; margin-right: 10px; margin-bottom: 0; }
#saveKeyBtn { margin-bottom: 15px; }
.hidden { display: none; }
#modelSelect { background: white; }
#diffView { margin-top: 20px; border: 1px solid #ddd; padding: 10px; overflow: auto; max-height: none; height: auto; }
.d2h-wrapper { width: 100%; overflow-x: auto; }
.d2h-file-side-by-side { table-layout: fixed; width: 100%; border-collapse: collapse; }
.d2h-file-side-by-side .d2h-code-wrapper { position: relative; height: auto; overflow-y: visible; }
.d2h-file-side-by-side .d2h-code-side { width: 50%; float: left; box-sizing: border-box; }
.d2h-code-linenumber { position: relative !important; width: 50px; text-align: right; padding: 0 5px; }
.d2h-code-line { white-space: pre-wrap; word-wrap: break-word; }
.diff { font-family: monospace; font-size: 14px; }
.diff-added { background: #e6ffed; color: #22863a; }
.diff-removed { background: #ffeef0; color: #b31d28; }
#download { margin-bottom: 20px; }  /* Space between download and diffView */
.d2h-file-header { display: none; }  /* Hide header if not needed */
.d2h-file-diff { overflow-y: auto; max-height: 400px; }  /* Scrollable diff table */
/* -------------------------
   Dark mode overrides
   ------------------------- */
body.dark {
  background: #121212;
  color: #e6e6e6;
}
body.dark h1 { color: #e6e6e6; }
body.dark label { color: #e6e6e6; }
body.dark a { color: #8ab4f8; }

body.dark textarea,
body.dark input[type="file"],
body.dark input[type="password"],
body.dark select {
  background: #1e1e1e;
  color: #e6e6e6;
  border-color: #3a3a3a;
}

body.dark #modelSelect { background: #1e1e1e; }
body.dark #output {
  background: #1e1e1e;
  color: #e6e6e6;
  border-color: #3a3a3a;
}
body.dark #apiKey:disabled { background: #2a2a2a; color: #bdbdbd; }
body.dark #key-warning { color: #ffb74d; }

body.dark button { background: #2d6cdf; }
body.dark button:hover { background: #2456ad; }
body.dark button:disabled { background: #444; }

/* Diff view (basic dark styling) */
body.dark #diffView {
  background: #1a1a1a;
  border-color: #3a3a3a;
}
body.dark .d2h-wrapper { background: #1a1a1a; color: #e6e6e6; }
body.dark .d2h-code-linenumber { color: #a0a0a0; }

/* -------------------------
   Diff2Html dark mode
   ------------------------- */
body.dark .d2h-wrapper,
body.dark .d2h-file-diff,
body.dark .d2h-diff-table,
body.dark .d2h-diff-tbody,
body.dark .d2h-files-diff,
body.dark .d2h-code-wrapper {
  background: #1a1a1a;
  color: #e6e6e6;
}

body.dark .d2h-diff-table,
body.dark .d2h-diff-tbody td {
  border-color: #333;
}

/* Unchanged lines + code cells */
body.dark .d2h-code-side-line,
body.dark .d2h-code-line,
body.dark .d2h-code-line-ctn {
  background: #1a1a1a;
  color: #e6e6e6;
}

/* Line number gutters (left, middle, right) */
body.dark td.d2h-code-linenumber,
body.dark .d2h-code-linenumber {
  background: #161616;
  color: #a0a0a0;
  border-color: #333;
}

/* Hunk headers (@@ ... @@) */
body.dark .d2h-info,
body.dark tr.d2h-info td {
  background: #202020;
  color: #cfcfcf;
}

/* Added / removed blocks */
body.dark .d2h-ins,
body.dark tr.d2h-ins td {
  background: rgba(46, 160, 67, 0.18);
}
body.dark .d2h-del,
body.dark tr.d2h-del td {
  background: rgba(248, 81, 73, 0.18);
}

/* The little +/- markers (if present) */
body.dark .d2h-code-line-prefix {
  color: #a0a0a0;
}

/* Optional: file-name/header bits if you ever enable them */
body.dark .d2h-file-name-wrapper,
body.dark .d2h-file-wrapper {
  background: #1a1a1a;
  border-color: #333;
}
/* =========================
   Diff2Html DARK (strong overrides)
   Put this at END of styles.css
   ========================= */

/* Base: force all diff table cells dark */
body.dark #diffView .d2h-diff-table,
body.dark #diffView .d2h-diff-tbody {
  background-color: #1a1a1a !important;
  color: #e6e6e6 !important;
}

body.dark #diffView .d2h-diff-table tr:not(.d2h-ins):not(.d2h-del) td,
body.dark #diffView .d2h-diff-table tr:not(.d2h-ins):not(.d2h-del) th {
  background-color: #1a1a1a !important;
  color: #e6e6e6 !important;
  border-color: #333 !important;
}

/* Line-number boxes (left, center, right gutters) */
body.dark #diffView td.d2h-code-linenumber,
body.dark #diffView td.d2h-code-side-linenumber,
body.dark #diffView .d2h-code-linenumber {
  background-color: #161616 !important;
  color: #a0a0a0 !important;
  border-color: #333 !important;
}

/* Code text cells */
body.dark #diffView td.d2h-code-line,
body.dark #diffView .d2h-code-line,
body.dark #diffView .d2h-code-line-ctn,
body.dark #diffView .d2h-code-side-line {
  background-color: #1a1a1a !important;
  color: #e6e6e6 !important;
}

/* Context (unchanged) rows */
body.dark #diffView tr.d2h-cntx td {
  background-color: #1a1a1a !important;
  color: #e6e6e6 !important;
}

/* Hunk header rows (@@ ... @@) */
body.dark #diffView tr.d2h-info td,
body.dark #diffView .d2h-info {
  background-color: #202020 !important;
  color: #cfcfcf !important;
}

/* Added / removed rows (apply to TDs, not just TR) */
body.dark #diffView tr.d2h-ins td {
  background-color: rgba(46, 160, 67, 0.22) !important;
}
body.dark #diffView tr.d2h-del td {
  background-color: rgba(248, 81, 73, 0.22) !important;
}

/* Empty placeholder cells (side-by-side sometimes has these) */
body.dark #diffView .d2h-emptyplaceholder {
  background-color: #1a1a1a !important;
  color: #777 !important;
}

/* If any header/name wrappers appear */
body.dark #diffView .d2h-file-wrapper,
body.dark #diffView .d2h-file-name-wrapper {
  background-color: #1a1a1a !important;
  border-color: #333 !important;
}
/* =========================
   Fix diff highlighting in DARK mode
   (put at END of styles.css)
   ========================= */

/* Added lines: tint BOTH line-number cells + code cells */
body.dark #diffView tr.d2h-ins td.d2h-code-linenumber,
body.dark #diffView tr.d2h-ins td.d2h-code-side-linenumber {
  background-color: rgba(46, 160, 67, 0.35) !important;   /* darker green */
  color: #e6e6e6 !important;
}

body.dark #diffView tr.d2h-ins td.d2h-code-line,
body.dark #diffView tr.d2h-ins td.d2h-code-side-line,
body.dark #diffView tr.d2h-ins td .d2h-code-line-ctn {
  background-color: rgba(46, 160, 67, 0.22) !important;   /* green tint on code area */
  color: #e6e6e6 !important;
}

/* Removed lines: tint BOTH line-number cells + code cells */
body.dark #diffView tr.d2h-del td.d2h-code-linenumber,
body.dark #diffView tr.d2h-del td.d2h-code-side-linenumber {
  background-color: rgba(248, 81, 73, 0.35) !important;   /* darker red */
  color: #e6e6e6 !important;
}

body.dark #diffView tr.d2h-del td.d2h-code-line,
body.dark #diffView tr.d2h-del td.d2h-code-side-line,
body.dark #diffView tr.d2h-del td .d2h-code-line-ctn {
  background-color: rgba(248, 81, 73, 0.22) !important;   /* red tint on code area */
  color: #e6e6e6 !important;
}

/* If diff2html marks inline/word changes, make them visible too (safe even if unused) */
body.dark #diffView .d2h-change,
body.dark #diffView .d2h-chg {
  background-color: rgba(255, 193, 7, 0.22) !important;
  color: #e6e6e6 !important;
}

/* --- FINAL: make added/removed visible even if class is on td/span --- */

/* Removed */
body.dark #diffView .d2h-del,
body.dark #diffView tr.d2h-del td,
body.dark #diffView td.d2h-del,
body.dark #diffView .d2h-del .d2h-code-line,
body.dark #diffView .d2h-del .d2h-code-side-line,
body.dark #diffView .d2h-del .d2h-code-line-ctn {
  background-color: rgba(248, 81, 73, 0.22) !important;
  color: #e6e6e6 !important;
}

/* Added */
body.dark #diffView .d2h-ins,
body.dark #diffView tr.d2h-ins td,
body.dark #diffView td.d2h-ins,
body.dark #diffView .d2h-ins .d2h-code-line,
body.dark #diffView .d2h-ins .d2h-code-side-line,
body.dark #diffView .d2h-ins .d2h-code-line-ctn {
  background-color: rgba(46, 160, 67, 0.22) !important;
  color: #e6e6e6 !important;
}

/* Line number boxes in changed rows */
body.dark #diffView tr.d2h-del td.d2h-code-linenumber,
body.dark #diffView tr.d2h-del td.d2h-code-side-linenumber,
body.dark #diffView tr.d2h-ins td.d2h-code-linenumber,
body.dark #diffView tr.d2h-ins td.d2h-code-side-linenumber,
body.dark #diffView td.d2h-del.d2h-code-linenumber,
body.dark #diffView td.d2h-ins.d2h-code-linenumber {
  background-color: rgba(255, 255, 255, 0.06) !important;
  color: #e6e6e6 !important;
}